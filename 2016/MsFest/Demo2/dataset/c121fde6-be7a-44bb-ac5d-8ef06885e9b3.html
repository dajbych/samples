 <html lang="cs-CZ"> <head> <meta charset="UTF-8" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <title>Bayesovský bandita: chytřejší a levnější A/B testování | Machine Learning Guru</title> <link rel="profile" href="http://gmpg.org/xfn/11" /> <link rel="pingback" href="http://www.mlguru.cz/xmlrpc.php" /> <link rel="alternate" type="application/rss+xml" title="Machine Learning Guru » RSS zdroj" href="http://www.mlguru.cz/feed/" /> <link rel="alternate" type="application/rss+xml" title="Machine Learning Guru » RSS komentářů" href="http://www.mlguru.cz/comments/feed/" /> <link rel="alternate" type="application/rss+xml" title="Machine Learning Guru » RSS komentářů pro Bayesovský bandita: chytřejší a levnější A/B testování" href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/feed/" /> <script type="text/javascript">
			window._wpemojiSettings = {&quot;baseUrl&quot;:&quot;https:\/\/s.w.org\/images\/core\/emoji\/72x72\/&quot;,&quot;ext&quot;:&quot;.png&quot;,&quot;source&quot;:{&quot;concatemoji&quot;:&quot;http:\/\/www.mlguru.cz\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.5&quot;}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement(&quot;canvas&quot;),g=f.getContext&amp;&amp;f.getContext(&quot;2d&quot;),h=String.fromCharCode;return g&amp;&amp;g.fillText?(g.textBaseline=&quot;top&quot;,g.font=&quot;600 32px Arial&quot;,&quot;flag&quot;===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length&gt;3e3):&quot;diversity&quot;===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+&quot;,&quot;+c[1]+&quot;,&quot;+c[2]+&quot;,&quot;+c[3],d!==e):(&quot;simple&quot;===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement(&quot;script&quot;);c.src=a,c.type=&quot;text/javascript&quot;,b.getElementsByTagName(&quot;head&quot;)[0].appendChild(c)}var f,g;c.supports={simple:d(&quot;simple&quot;),flag:d(&quot;flag&quot;),unicode8:d(&quot;unicode8&quot;),diversity:d(&quot;diversity&quot;)},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&amp;&amp;c.supports.flag&amp;&amp;c.supports.unicode8&amp;&amp;c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener(&quot;DOMContentLoaded&quot;,g,!1),a.addEventListener(&quot;load&quot;,g,!1)):(a.attachEvent(&quot;onload&quot;,g),b.attachEvent(&quot;onreadystatechange&quot;,function(){&quot;complete&quot;===b.readyState&amp;&amp;c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&amp;&amp;f.twemoji&amp;&amp;(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> <style type="text/css"> img.wp-smiley, img.emoji { display: inline !important; border: none !important; box-shadow: none !important; height: 1em !important; width: 1em !important; margin: 0 .07em !important; vertical-align: -0.1em !important; background: none !important; padding: 0 !important; } </style> <link rel="stylesheet" id="ssbaFont-css" href="//fonts.googleapis.com/css?family=Indie+Flower&ver=4.4.5" type="text/css" media="all" /> <link rel="stylesheet" id="radiate-style-css" href="http://www.mlguru.cz/wp-content/themes/radiate/style.css?ver=4.4.5" type="text/css" media="all" /> <link rel="stylesheet" id="radiate-google-fonts-css" href="//fonts.googleapis.com/css?family=Roboto%7CMerriweather%3A400%2C300&ver=4.4.5" type="text/css" media="all" /> <script type="text/javascript" src="http://www.mlguru.cz/wp-includes/js/jquery/jquery.js?ver=1.11.3" /> <script type="text/javascript" src="http://www.mlguru.cz/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1" /> <link rel="https://api.w.org/" href="http://www.mlguru.cz/wp-json/" /> <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mlguru.cz/xmlrpc.php?rsd" /> <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mlguru.cz/wp-includes/wlwmanifest.xml" /> <link rel="prev" title="Pravděpodobnostní programovací jazyky" href="http://www.mlguru.cz/pravdepodobnostni-programovaci-jazyky/" /> <link rel="next" title="Analýza prezidentských projevů" href="http://www.mlguru.cz/analyza-prezidentskych-projevu/" /> <meta name="generator" content="WordPress 4.4.5" /> <link rel="canonical" href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/" /> <link rel="shortlink" href="http://www.mlguru.cz/?p=167" /> <link rel="alternate" type="application/json+oembed" href="http://www.mlguru.cz/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.mlguru.cz%2Fbayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani%2F" /> <link rel="alternate" type="text/xml+oembed" href="http://www.mlguru.cz/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.mlguru.cz%2Fbayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani%2F&format=xml" /> <script>
jQuery(document).ready(function(){
jQuery(&quot;html&quot;).attr(&quot;xmlns:og&quot;,&quot;http://opengraphprotocol.org/schema/&quot;);
});
</script> <meta property="og:type" content="article" /> <meta property="og:title" content="Bayesovský bandita: chytřejší a levnější A/B testování" /> <meta property="og:site_name" content="Machine Learning Guru" /> <meta property="og:url" content="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/" /> <meta name="og:author" content="Jiří Materna" /> <style type="text/css"> .ssba { } .ssba img { width: 35px !important; padding: 6px; border: 0; box-shadow: none !important; display: inline !important; vertical-align: middle; } .ssba, .ssba a { text-decoration:none; border:0; background: none; font-family: Indie Flower; font-size: 20px; }</style> <style type="text/css" id="custom-header-css"> #parallax-bg { background-image: url(&apos;http://www.mlguru.cz/wp-content/uploads/2014/11/cropped-neurons2.png&apos;); background-repeat: repeat-x; background-position: center top; background-attachment: scroll; } #masthead { margin-bottom: 382px; } @media only screen and (max-width: 600px) { #masthead { margin-bottom: 314px; } } </style> <style type="text/css" id="custom-background-css"> body.custom-background { background: none !important; } #content { background-color: #EAEAEA; } </style> <style type="text/css"> blockquote { border-color: #EAEAEA #EAEAEA #EAEAEA #0066bf; } a { color: #0066bf; } .site-title a:hover { color: #0066bf; } .main-navigation a:hover, .main-navigation ul li.current-menu-item a, .main-navigation ul li.current_page_ancestor a, .main-navigation ul li.current-menu-ancestor a, .main-navigation ul li.current_page_item a, .main-navigation ul li:hover &gt; a { background-color: #0066bf; } .main-navigation ul li ul li a:hover, .main-navigation ul li ul li:hover &gt; a, .main-navigation ul li.current-menu-item ul li a:hover { background-color: #0066bf; } #masthead .search-form { background-color: #0066bf; } .header-search-icon:before { color: #0066bf; } button, input[type=&quot;button&quot;], input[type=&quot;reset&quot;], input[type=&quot;submit&quot;] { background-color: #0066bf; } #content .entry-title a:hover { color: #0066bf; } .entry-meta span:hover { color: #0066bf; } #content .entry-meta span a:hover { color: #0066bf; } #content .comments-area article header cite a:hover, #content .comments-area a.comment-edit-link:hover, #content .comments-area a.comment-permalink:hover { color: #0066bf; } .comments-area .comment-author-link a:hover { color: #0066bf; } .comment .comment-reply-link:hover { color: #0066bf; } .site-header .menu-toggle { color: #0066bf; } .site-header .menu-toggle:hover { color: #0066bf; } .main-small-navigation li:hover { background: #0066bf; } .main-small-navigation ul &gt; .current_page_item, .main-small-navigation ul &gt; .current-menu-item { background: #0066bf; } .main-small-navigation ul li ul li a:hover, .main-small-navigation ul li ul li:hover &gt; a, .main-small-navigation ul li.current-menu-item ul li a:hover { background-color: #0066bf; } #featured_pages a.more-link:hover { border-color:#0066bf; color:#0066bf; } a#back-top:before { background-color:#0066bf; }</style> <style type="text/css" /> <style type="text/css"> /*  */
img.latex { vertical-align: middle; border: none; }
/*  */ </style> <style type="text/css" id="syntaxhighlighteranchor" />  <script>
  (function(i,s,o,g,r,a,m){i[&apos;GoogleAnalyticsObject&apos;]=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,&apos;script&apos;,&apos;//www.google-analytics.com/analytics.js&apos;,&apos;ga&apos;);
  ga(&apos;create&apos;, &apos;UA-56776992-1&apos;, &apos;auto&apos;);
  ga(&apos;send&apos;, &apos;pageview&apos;);
</script>  </head> <body class="single single-post postid-167 single-format-standard"> <div id="parallax-bg" /> <div id="page" class="hfeed site"> <header id="masthead" class="site-header" role="banner"> <div class="header-wrap clearfix"> <div class="site-branding"> <h1 class="site-title"><a href="http://www.mlguru.cz/" title="Machine Learning Guru" rel="home">Machine Learning Guru</a></h1> <div class="site-description"> Český blog o strojovém učení.</div> </div> <div class="header-search-icon" /> <form role="search" method="get" class="search-form" action="http://www.mlguru.cz/"> <label> <span class="screen-reader-text">Search for:</span> <input type="search" class="search-field" placeholder="Hledat …" value name="s" /> </label> <input type="submit" class="search-submit" value="Hledat" /> </form> <nav id="site-navigation" class="main-navigation" role="navigation"> <h1 class="menu-toggle" /> <a class="skip-link screen-reader-text" href="#content">Přeskočit k obsahu</a> <div class="menu"><ul><li><a href="http://www.mlguru.cz/">Úvodní stránka</a></li><li class="page_item page-item-2"><a href="http://www.mlguru.cz/kontakt/">Kontakt</a></li></ul></div> </nav> </div> </header> <div id="content" class="site-content"> <div class="inner-wrap"> <div id="primary" class="content-area"> <main id="main" class="site-main" role="main"> <article id="post-167" class="post-167 post type-post status-publish format-standard hentry category-statistika category-testovani"> <header class="entry-header"> <h1 class="entry-title">Bayesovský bandita: chytřejší a levnější A/B testování</h1> <div class="entry-meta"> <span class="posted-on"><a href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/" rel="bookmark"><time class="entry-date published" datetime="2014-12-09T08:50:37+00:00">Prosinec 9, 2014</time><time class="updated" datetime="2015-04-13T20:13:24+00:00">Duben 13, 2015</time></a></span><span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.mlguru.cz/author/admin/">Jiří Materna</a></span></span> </div> </header> <div class="entry-content"> <div class="kcite-section" kcite-section-id="167"> <p><a href="http://www.mlguru.cz/wp-content/uploads/2014/12/1024px-Las_Vegas_slot_machines.jpg"><img class="alignleft wp-image-177 size-medium" src="http://www.mlguru.cz/wp-content/uploads/2014/12/1024px-Las_Vegas_slot_machines-300x209.jpg" alt="Slot Machines" width="300" height="209" srcset="http://www.mlguru.cz/wp-content/uploads/2014/12/1024px-Las_Vegas_slot_machines-300x209.jpg 300w, http://www.mlguru.cz/wp-content/uploads/2014/12/1024px-Las_Vegas_slot_machines.jpg 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p> <p>Představme si jednoduchou situaci. Řekněme, že jsme vlastníky internetového e-shopu s radiátory a chceme začít prodávat nejnovější typ. Ten má sice o něco lepší vlastnosti než staré modely, ale je o třetinu dražší, a zákazníci tak stále preferují starší varianty. Proto se rozhodneme, že ho začneme propagovat na úvodní stránce prostřednictvím banneru. Na prodeji tohoto modelu nám opravdu hodně záleží, a tak jsme si zaplatili profesionála, který připravil tři grafické návrhy. Otázka teď zní: jaký grafický návrh vybereme?</p> <p>Nejjednodušší možností, kterou v takovém případě volí většina majitelů e-shopů, je vlastní úsudek. Ten je ovšem velmi subjektivní a vůbec nemusí odpovídat preferencím zákazníků. Lepší možností je využití takzvaného A/B testování. To spočívá v tom, že po nějakou dobu všechny bannery střídáme a pro každý z nich měříme poměr prokliků vůči počtu jeho zobrazení (<a title="CRT" href="http://en.wikipedia.org/wiki/Click-through_rate">CTR</a>). Po nasbírání průkazného množství dat vybere banner s nejvyšší hodnotou CTR.</p> <p>Tato metoda však není ideální. Návštěvnost e-shopu s radiátory asi nebude nijak závratná, proto může trvat velmi dlouho než nasbíráme dostatek dat pro kvalifikované rozhodnutí. Pokud bude navíc některý z bannerů výrazně méně atraktivní pro uživatele, jeho zobrazováním namísto jiného můžeme přijít o velké peníze. Naším cílem je tedy odhalit nejatraktivnější banner co nejdříve.</p> <p>Moje oblíbená metoda, která patří mezi nejefektivnější, nese název bayesovský bandita. Pojmenování pochází z optimalizační úlohy známé jako <a title="problém mnohorukého bandity" href="http://en.wikipedia.org/wiki/Multi-armed_bandit">problém mnohorukého bandity</a>. Jedná se o problém, ve kterém máme řadu výherních automatů (v angličtině nazývaných <a title="one-armed bandit" href="http://en.wikipedia.org/wiki/Slot_machine">one-armed bandit</a>), každý s jinou pravděpodobností výhry, a naším cílem je nalézt posloupnost, v jaké na jednotlivých automatech hrát tak, abychom maximalizovali výnos. Jinými slovy, chceme co nejrychleji nalézt automat, u kterého je pravděpodobnost výhry nejvyšší a dále hrát pouze na tomto automatu. Analogie s bannery v e-shopu je přímočará − naším cílem je co nejdříve nalézt banner s nejvyšším CTR.</p> <p>Jak sám název metody napovídá, je k tomu využita bayesovská statistika. Konkrétně jsou CTR jednotlivých bannerů odhadována samplováním z <a title="beta rozdělení" href="http://en.wikipedia.org/wiki/Beta_distribution">beta rozdělení</a>. V obecnosti se jedná o rozdělení s parametry α a β definované jako</p> <p align="center"><img src="http://s0.wp.com/latex.php?latex=Beta%28x%7C%5Calpha%2C+%5Cbeta%29+%3D+%5Cdfrac%7B%5CGamma%28%5Calpha+%2B+%5Cbeta%29%7D%7B%5CGamma%28%5Calpha%29%5CGamma%28%5Cbeta%29%7Dx%5E%7B%5Calpha-1%7D%281+-+x%29%5E%7B%5Cbeta-1%7D.+&bg=ffffff&fg=000000&s=0" alt="Beta(x|\alpha, \beta) = \dfrac{\Gamma(\alpha + \beta)}{\Gamma(\alpha)\Gamma(\beta)}x^{\alpha-1}(1 - x)^{\beta-1}. " title="Beta(x|\alpha, \beta) = \dfrac{\Gamma(\alpha + \beta)}{\Gamma(\alpha)\Gamma(\beta)}x^{\alpha-1}(1 - x)^{\beta-1}. " class="latex" /></p> <p>Pro ilustraci jsou křivky hustoty pravděpodobnosti beta rozdělení pro některé hodnoty α a β jsou zachyceny na obrázku 1.</p> <p><a href="http://www.mlguru.cz/wp-content/uploads/2014/12/beta11-e1418051791178.png"><img class="aligncenter wp-image-183 size-full" src="http://www.mlguru.cz/wp-content/uploads/2014/12/beta11-e1418051791178.png" alt width="600" height="423" /></a></p> <p>Pro porozumění je dobré si uvědomit, že beta rozdělení je v podstatě pravděpodobnostní rozdělení popisující pravděpodobnosti pravděpodobností. V našem případě je to rozdělení přes pravděpodobnosti prokliků (CTR). Tvar křivky určující beta rozdělení je dán parametry α a β. Pokud jsou oba rovny 1 (černá křivka), všechny hodnoty CTR jsou stejně pravděpodobné. V případě volby odlišných hodnot parametrů dochází k tomu, že některé hodnoty CTR jsou více pravděpodobné než jiné. Obecně platí, že je střední hodnota beta rozdělení určena vztahem</p> <p align="center"><img src="http://s0.wp.com/latex.php?latex=E%5Bx%5D+%3D+%5Cdfrac%7B%5Calpha%7D%7B%5Calpha+%2B+%5Cbeta%7D.+&bg=ffffff&fg=000000&s=0" alt="E[x] = \dfrac{\alpha}{\alpha + \beta}. " title="E[x] = \dfrac{\alpha}{\alpha + \beta}. " class="latex" /></p> <p>Pokud tedy budou například α i β stejné a zároveň větší než 1, bude vždy nejpravděpodobnější hodnotou CTR číslo kolem 0.5. Pokud budou hodnoty α a β v poměru 25:75, bude střední hodnota CTR 1/4 (modrá křivka). Další zajímavou vlastností beta rozdělení je fakt, že čím jsou hodnoty parametrů vyšší, tím menší je jeho rozptyl. Z praktického hlediska to znamená, že čím vyšší hodnoty parametrů α a β ve správném poměru zvolíme, tím přesnější odhad CTR budeme mít (zelená a červená křivka).</p> <p>Nyní se můžeme pustit do popisu algoritmu bayesovského bandity. Hlavní myšlenka spočívá v tom, že CTR každého banneru modelujeme pomocí beta rozdělení. Při hledání vhodného banneru k zobrazení náhodně vylosujeme hodnotu CTR ze všech tří beta rozdělení a zobrazíme ten banner, jehož vylosovaná hodnota CTR bude nejvyšší. Pokud uživatel na banner klikne, zvýšíme parametr α odpovídajícího beta rozdělení o 1. Pokud uživatel neklikne, zvýšíme o 1 hodnotu parametru β. Tento postup opakujeme při každém načtení úvodní stránky zobrazující banner.</p> <p>Vzhledem k tomu, že na začátku testování obvykle o CTR jednotlivých bannerů nevíme nic, algoritmus je u všech bannerů inicializován hodnotami α = β = 1. Žádný z nich tedy není preferovaný a všechny mají stejnou šanci na zobrazení. Dalšími kroky se odhad zpřesňuje a algoritmus postupně konverguje do stavu, kdy bude téměř vždy vyhrávat banner s nejvyšší skutečnou hodnotou CTR.</p> <p>Jeden z okamžiků rozhodování mezi bannery k zobrazení je zachycen na obrázku 2.</p> <div id="attachment_176" style="width: 610px" class="wp-caption aligncenter"><a href="http://www.mlguru.cz/wp-content/uploads/2014/12/beta2-e1417869285234.png"><img class="wp-image-176 size-full" src="http://www.mlguru.cz/wp-content/uploads/2014/12/beta2-e1417869285234.png" alt="Obrázek 2: Bayesovský bandita." width="600" height="423" /></a><p class="wp-caption-text">Obrázek 2: Bayesovský bandita.</p></div> <p>Jedná se o stav, kdy už byl každý z bannerů několikrát zobrazen a máme tedy hrubý odhad CTR. Střední hodnota banneru 1 na obrázku je 0.25, u banneru 2 je 0.4 a u banneru 3 je 0.67. Nejvyšší pravděpodobnost zobrazení má tedy banner 3. Nemusí však nutně zvítězit, protože aktuální CTR losujeme z příslušných beta rozdělení a například oblast okolo 0.5 má nenulovou pravděpodobnost u všech tří bannerů. Svislé čárkované čáry představují příklady vylosovaných hodnot. Vidíme, že oproti očekávání byl banner 2 předstižen bannerem 1, avšak nejvyšší hodnoty dosáhl přece jen banner 3. Proto ho zobrazíme.</p> <p>Jednoduchou implementaci algoritmu bayesovského bandity představuje následující kód v jazyce <a title="Python" href="http://en.wikipedia.org/wiki/Python_(programming_language)">Python</a>.</p> <pre class="brush: python; title: ; notranslate" title> from scipy.stats import beta from random import random class Banner(): def __init__(self, CTR, alpha=1, beta=1): self.CTR = CTR self.alpha = alpha self.beta = beta def update(self, click): if click == True: self.alpha += 1 else: self.beta += 1 def sample(self): return beta(self.alpha, self.beta).rvs() def getCTR(self): return self.CTR class BayesBandit: def __init__(self, CTRs): self.banners = [] for CTR in CTRs: self.banners.append(Banner(CTR)) def selectBanner(self): sampledCTRs = [banner.sample() for banner in self.banners] return sampledCTRs.index(max(sampledCTRs)) def simulateUser(self, banner): CTR = self.banners[banner].getCTR() if random() &lt; CTR: self.banners[banner].update(False) else: self.banners[banner].update(True) if __name__ == &quot;__main__&quot;: bandit = BayesBandit([0.25, 0.4, 0.67]) for i in range(100): banner = bandit.selectBanner() bandit.simulateUser(banner) print &quot;Banner %d&quot; % (banner + 1) </pre> <p>Třída <em>Banner</em>, definovaná na řádcích 4-20, implementuje jednotlivé bannery. Je inicializovaná skutečnou hodnotou CTR a volitelně počátečními parametry α a β. Metoda <em>update</em> provádí aktualizaci parametrů na základě toho, jestli uživatel klikl na banner poté, co se mu zobrazil. Metoda <em>sample</em> vybírá náhodnou hodnotu CTR z odpovídajícího beta rozdělení. Metoda <em>selectBanner</em> třídy <em>BayesBandit</em> nejprve vylosuje CTR pro všechny bannery a poté vrátí index banneru s nejvyšší hodnotou CTR. Simulace chování skutečného uživatele je prováděna v metodě <em>simulateUser. </em> Ta využívá skutečné hodnoty CTR banneru a rozhoduje o tom, zda by skutečný uživatel na banner klikl nebo ne. Samotný testovací program je zapsaný na řádcích 39-44. Nejprve jsou vytvořeny 3 bannery se skutečnými hodnotami CTR 0.25, 0.4 a 0.67. Poté je opakovaně vybírán banner k zobrazení a simulováno chování uživatele. Číslo zobrazeného banneru je v každém kroku vypsáno na standardní výstup. Po spuštění programu je vidět, že algoritmus zpočátku vybírá různé bannery, ale s rostoucím počtem iterací začíná preferovat banner 3. Už po dosažení 100 iterací je zobrazován téměř výhradně banner s nejvyšším skutečným CTR.</p> <p>Popsaný algoritmus předpokládá, že o skutečných hodnotách CTR před zahájením testování nic nevíme. To však nemusí platit vždy. Provozovatel e-shopu například může předem usoudit, že banner 3 bude u uživatelů oblíbenější než banner 1. Potom je možné nastavit vhodné iniciální hodnoty α a β namísto defaultních 1. Pokud bude odhad správný, konvergenci to ještě urychlí. Pokud by však byl iniciální expertní odhad výrazně odlišný od skutečných hodnot, algoritmus sice po čase dokonverguje do správných hodnot, ale bude k tomu zapotřebí mnohem více iterací.</p> <br /><iframe src="http://www.facebook.com/plugins/like.php?locale=cs_CZ&href=http%3A%2F%2Fwww.mlguru.cz%2Fbayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani%2F&layout=standard&show-faces=false&width=450&action=like&colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:40px" /><div class="ssba ssba-wrap"><div style="text-align:left"><a data-site class="ssba_facebook_share" href="http://www.facebook.com/sharer.php?u=http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/" target="_blank"><img src="http://www.mlguru.cz/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/facebook.png" title="Facebook" class="ssba ssba-img" alt="Share on Facebook" /></a><a data-site class="ssba_twitter_share" href="http://twitter.com/share?url=http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/&text=Bayesovsk%C3%BD+bandita%3A+chyt%C5%99ej%C5%A1%C3%AD+a+levn%C4%9Bj%C5%A1%C3%AD+A%2FB+testov%C3%A1n%C3%AD+" target="_blank"><img src="http://www.mlguru.cz/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" /></a><a data-site class="ssba_google_share" href="https://plus.google.com/share?url=http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/" target="_blank"><img src="http://www.mlguru.cz/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png" title="Google+" class="ssba ssba-img" alt="Share on Google+" /></a></div></div> </div>  </div> <footer class="entry-meta"> <span class="cat-links"> <a href="http://www.mlguru.cz/category/statistika/" rel="category tag">statistika</a>,<a href="http://www.mlguru.cz/category/testovani/" rel="category tag">testování</a> </span> <span class="comments-link"><a href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/#comments">7 Komentářů</a></span> </footer> </article> <nav class="navigation post-navigation" role="navigation"> <h1 class="screen-reader-text">Post navigation</h1> <div class="nav-links"> <div class="nav-previous"><a href="http://www.mlguru.cz/pravdepodobnostni-programovaci-jazyky/" rel="prev"><span class="meta-nav">←</span> Pravděpodobnostní programovací jazyky</a></div> <div class="nav-next"><a href="http://www.mlguru.cz/analyza-prezidentskych-projevu/" rel="next">Analýza prezidentských projevů <span class="meta-nav">→</span></a></div> </div> </nav> <div id="comments" class="comments-area"> <h2 class="comments-title"> 7 komentářů k “<span>Bayesovský bandita: chytřejší a levnější A/B testování</span>” </h2> <ul class="comment-list"> <li class="comment even thread-even depth-1" id="li-comment-8"> <article id="comment-8" class="comment"> <header class="comment-meta comment-author vcard"> <div class="comment-author-link"><a href="http://honza.poboril.cz" rel="external nofollow" class="url">Honza Pobořil</a></div><div class="comment-date-time">Prosinec 10, 2014 at 11:35 am</div> </header> <section class="comment-content comment"> <p>Chápu správně, že algoritmus bude správně fungovat jen pokud je průměrné chování uživatelů v čase konstantní? Tedy, že se neprojevují sezónní vlivy, dočasné změny poměru segmentů atd.?</p> <p>Stejný problém má i normální AB test, ale u něj mám alespoň čistá data na základě kterých jsem schopný navrhnout např. personalizaci (ve smysluplných případech).</p> <a rel="nofollow" class="comment-reply-link" href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/?replytocom=8#respond" onclick="return addComment.moveForm( "comment-8", "8", "respond", "167" )" aria-label="Odpovědět: Honza Pobořil">Odpovědět</a> </section> </article> <ul class="children"> <li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-10"> <article id="comment-10" class="comment"> <header class="comment-meta comment-author vcard"> <div class="comment-author-link"><a href="http://www.mlguru.cz" rel="external nofollow" class="url">Jiří Materna</a><span>Autor článku</span></div><div class="comment-date-time">Prosinec 10, 2014 at 2:17 pm</div> </header> <section class="comment-content comment"> <p>Nemusí to tak být. Pokud je změna trvalejšího rázu, odhad se opraví sám. Pokud se dá očekávat, že bude CTR ovlivněno sezónností nebo nějakými dočasnými okolnostmi, je možné počítat statistiky v pohyblivém okně (například vždy za poslední týden) a starší data zapomínat.</p> <a rel="nofollow" class="comment-reply-link" href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/?replytocom=10#respond" onclick="return addComment.moveForm( "comment-10", "10", "respond", "167" )" aria-label="Odpovědět: Jiří Materna">Odpovědět</a> </section> </article> </li> </ul> </li> <li class="comment even thread-odd thread-alt depth-1" id="li-comment-9"> <article id="comment-9" class="comment"> <header class="comment-meta comment-author vcard"> <div class="comment-author-link"><a href="http://honza.poboril.cz" rel="external nofollow" class="url">Honza Pobořil</a></div><div class="comment-date-time">Prosinec 10, 2014 at 11:36 am</div> </header> <section class="comment-content comment"> <p>PS: Chybí mi tady možnost notifikace nového komentáře.</p> <a rel="nofollow" class="comment-reply-link" href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/?replytocom=9#respond" onclick="return addComment.moveForm( "comment-9", "9", "respond", "167" )" aria-label="Odpovědět: Honza Pobořil">Odpovědět</a> </section> </article> <ul class="children"> <li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-11"> <article id="comment-11" class="comment"> <header class="comment-meta comment-author vcard"> <div class="comment-author-link"><a href="http://www.mlguru.cz" rel="external nofollow" class="url">Jiří Materna</a><span>Autor článku</span></div><div class="comment-date-time">Prosinec 10, 2014 at 2:18 pm</div> </header> <section class="comment-content comment"> <p>Díky za podnět, zkusím to tam přidat.</p> <a rel="nofollow" class="comment-reply-link" href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/?replytocom=11#respond" onclick="return addComment.moveForm( "comment-11", "11", "respond", "167" )" aria-label="Odpovědět: Jiří Materna">Odpovědět</a> </section> </article> </li> </ul> </li> <li class="comment even thread-even depth-1" id="li-comment-22"> <article id="comment-22" class="comment"> <header class="comment-meta comment-author vcard"> <div class="comment-author-link"><a href="https://github.com/otakar-smrz/" rel="external nofollow" class="url">Otakar Smrž</a></div><div class="comment-date-time">Únor 3, 2015 at 1:14 pm</div> </header> <section class="comment-content comment"> <p>Děkuju za pěkný článek. Experimentoval jsem s kódem, abych zjistil, jak se hodnoty <a href="http://en.wikipedia.org/wiki/Beta_distribution#Mean" rel="nofollow"><em>alpha / (alpha + beta)</em></a> a <a href="http://en.wikipedia.org/wiki/Beta_distribution#Mode" rel="nofollow"><em>(alpha - 1) / (alpha + beta - 2)</em></a> blíží apriornímu CTR. Zajímavé je, že dobrý odhad získá právě ten jeden nejlepší banner. Kdyby se uživateli zobrazovalo <em>n</em> bannerů zároveň, patrně by dobrý odhad získalo <em>n</em> bannerů s nejlepší apriorní CTR.</p> <p>Vzhledem z tomu, jak je v článku definován význam parametrů beta rozdělení a že klik odpovídá <em>random() &lt; CTR</em>, bych pro lepší srozumitelnost upravil kód takto:<br /> <code><br /> def update(self, click):<br /> if click:<br /> self.alpha += 1<br /> else:<br /> self.beta += 1<br /> </code><br /> <code><br /> def simulateUser(self, banner):<br /> CTR = self.banners[banner].getCTR()<br /> self.banners[banner].update(random() &lt; CTR)<br /> </code></p> <a rel="nofollow" class="comment-reply-link" href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/?replytocom=22#respond" onclick="return addComment.moveForm( "comment-22", "22", "respond", "167" )" aria-label="Odpovědět: Otakar Smrž">Odpovědět</a> </section> </article> </li> <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-25"> <article id="comment-25" class="comment"> <header class="comment-meta comment-author vcard"> <div class="comment-author-link">Honza Schauta</div><div class="comment-date-time">Duben 9, 2015 at 1:25 pm</div> </header> <section class="comment-content comment"> <p>Zajimavy clanek, inspiroval nas a prave implementujeme.<br /> Rekl bych ale, ze v clanku je na nekterych mistech prehozeny vyznam alfy a bety.</p> <p>&quot;... Pokud uživatel na banner klikne, zvýšíme parametr β odpovídajícího beta rozdělení o 1...&quot;<br /> A stejne tak v te ukazkove implementaci v metode update.</p> <p>Nemela by se pri kliku navysovat alfa?</p> <a rel="nofollow" class="comment-reply-link" href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/?replytocom=25#respond" onclick="return addComment.moveForm( "comment-25", "25", "respond", "167" )" aria-label="Odpovědět: Honza Schauta">Odpovědět</a> </section> </article> <ul class="children"> <li class="comment byuser comment-author-admin bypostauthor even depth-2" id="li-comment-26"> <article id="comment-26" class="comment"> <header class="comment-meta comment-author vcard"> <div class="comment-author-link"><a href="http://www.mlguru.cz" rel="external nofollow" class="url">Jiří Materna</a><span>Autor článku</span></div><div class="comment-date-time">Duben 13, 2015 at 8:15 pm</div> </header> <section class="comment-content comment"> <p>Díky za upozornění. Máte pravdu, alfy a bety v článku byly trochu pomíchané. Už by to snad mělo být v pořádku.</p> <a rel="nofollow" class="comment-reply-link" href="http://www.mlguru.cz/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/?replytocom=26#respond" onclick="return addComment.moveForm( "comment-26", "26", "respond", "167" )" aria-label="Odpovědět: Jiří Materna">Odpovědět</a> </section> </article> </li> </ul> </li> </ul> <div id="respond" class="comment-respond"> <h3 id="reply-title" class="comment-reply-title">Napsat komentář <small><a rel="nofollow" id="cancel-comment-reply-link" href="/bayesovsky-bandita-chytrejsi-a-levnejsi-ab-testovani/#respond" style="display:none;">Zrušit odpověď na komentář</a></small></h3> <form action="http://www.mlguru.cz/wp-comments-post.php" method="post" id="commentform" class="comment-form"> <p class="comment-notes"><span id="email-notes">Vaše emailová adresa nebude zveřejněna.</span></p><p class="comment-form-comment"><label for="comment">Komentář</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-required="true" required="required" /></p><p class="comment-form-author"><label for="author">Jméno</label> <input id="author" name="author" type="text" value size="30" /></p> <p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="text" value size="30" aria-describedby="email-notes" /></p> <p class="comment-form-url"><label for="url">Webová stránka</label> <input id="url" name="url" type="text" value size="30" /></p> <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Odeslat komentář" /> <input type="hidden" name="comment_post_ID" value="167" id="comment_post_ID" /> <input type="hidden" name="comment_parent" id="comment_parent" value="0" /> </p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="d367d0c54a" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="235" /></p> </form> </div> </div> </main> </div> <div id="secondary" class="widget-area" role="complementary"> <aside id="recent-posts-2" class="widget widget_recent_entries"> <h1 class="widget-title">Nejnovější příspěvky</h1> <ul> <li> <a href="http://www.mlguru.cz/konvergence-algoritmu-k-means/">Konvergence algoritmu k-means</a> </li> <li> <a href="http://www.mlguru.cz/je-singularita-blizko/">Je singularita blízko?</a> </li> <li> <a href="http://www.mlguru.cz/basnik/">Středověk umělé inteligence skončil, seznamte se s neuronovými sítěmi, které umí psát básně</a> </li> <li> <a href="http://www.mlguru.cz/word2vec-jednoducha-aritmetika-se-slovy/">word2vec – jednoduchá aritmetika se slovy</a> </li> <li> <a href="http://www.mlguru.cz/analyza-prezidentskych-projevu/">Analýza prezidentských projevů</a> </li> </ul> </aside> <aside id="banner-3" class="widget aibwp_banner_widget"> <h1 class="widget-title">Poezie umělého světa</h1>  <a href="http://www.kosmas.cz/knihy/216522/poezie-umeleho-sveta/ " target="_self"> <img src="http://www.mlguru.cz/wp-content/uploads/2016/05/poezie_umeleho_sveta.png" alt title class="banner-image" width="100%" /></a>  <p id="text_description"> Sbírka počítačem generované poezie.</p> </aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archiv</h1> <ul> <li><a href="http://www.mlguru.cz/2016/06/">Červen 2016</a></li> <li><a href="http://www.mlguru.cz/2016/03/">Březen 2016</a></li> <li><a href="http://www.mlguru.cz/2015/08/">Srpen 2015</a></li> <li><a href="http://www.mlguru.cz/2015/03/">Březen 2015</a></li> <li><a href="http://www.mlguru.cz/2014/12/">Prosinec 2014</a></li> <li><a href="http://www.mlguru.cz/2014/11/">Listopad 2014</a></li> </ul> </aside><aside id="anyusertwitterfeed-3" class="widget widget_anyusertwitterfeed"><h1 class="widget-title">Twitter</h1><div id="wds-container"> <div id="wds"> <div id="wds-header"> <div id="wds-twitter-icon"><a href="http://twitter.com" target="_blank">twitter</a></div> <a href="https://twitter.com/JiriMaterna" target="_blank"> <img src="https://pbs.twimg.com/profile_images/439683153284710400/xreA7gzt_normal.jpeg" class="wds-avatar" /> <span class="wds-display-name">Jiří Materna</span> <span class="wds-screen-name"> @JiriMaterna</span> </a> <div style="clear: both;" /> </div> <div id="wds-tweets"> <div class="wds-tweet-container "> <div class="wds-tweet"> <a href="https://twitter.com/intent/user?screen_name=JiriMaterna" target="_blank">JiriMaterna</a> Do you want to change the future (and earn some money)? Participate in the General AI challenge: <a class="url" href="https://t.co/EfiHzxw41A" rel="external" target="_blank">https://t.co/EfiHzxw41A</a> <a class="hashtag" href="http://twitter.com/search?q=%23AI" rel="external" target="_blank">#AI</a> </div> <div class="wds-tweet-data"> <a href="https://twitter.com/JiriMaterna/statuses/801483074571792384" target="_blank">Lis 23</a> • <a href="https://twitter.com/intent/tweet?in_reply_to=801483074571792384" target="_blank">reply</a> • <a href="https://twitter.com/intent/retweet?tweet_id=801483074571792384" target="_blank">retweet</a> • <a href="https://twitter.com/intent/favorite?tweet_id=801483074571792384" target="_blank">favorite</a> </div> </div> <div class="wds-tweet-container "> <div class="wds-tweet"> <a href="https://twitter.com/intent/user?screen_name=JiriMaterna" target="_blank">JiriMaterna</a> Nice and funny way of collecting training data for sketch recognition. <a class="url" href="https://t.co/feC3SbGjJM" rel="external" target="_blank">https://t.co/feC3SbGjJM</a> via @<a class="username" href="http://twitter.com/h_onza" rel="external" target="_blank">h_onza</a>. </div> <div class="wds-tweet-data"> <a href="https://twitter.com/JiriMaterna/statuses/799279588568420352" target="_blank">Lis 17</a> • <a href="https://twitter.com/intent/tweet?in_reply_to=799279588568420352" target="_blank">reply</a> • <a href="https://twitter.com/intent/retweet?tweet_id=799279588568420352" target="_blank">retweet</a> • <a href="https://twitter.com/intent/favorite?tweet_id=799279588568420352" target="_blank">favorite</a> </div> </div> <div class="wds-tweet-container  wds-last"> <div class="wds-tweet"> <a href="https://twitter.com/intent/user?screen_name=JiriMaterna" target="_blank">JiriMaterna</a> Yes, we will organize another @<a class="username" href="http://twitter.com/mlprague" rel="external" target="_blank">mlprague</a> conference in 2017. You can see more info on our website <a class="url" href="https://t.co/3vpyX0RnlH" rel="external" target="_blank">https://t.co/3vpyX0RnlH</a>. <a class="hashtag" href="http://twitter.com/search?q=%23machinelearning" rel="external" target="_blank">#machinelearning</a> </div> <div class="wds-tweet-data"> <a href="https://twitter.com/JiriMaterna/statuses/798538206492950528" target="_blank">Lis 15</a> • <a href="https://twitter.com/intent/tweet?in_reply_to=798538206492950528" target="_blank">reply</a> • <a href="https://twitter.com/intent/retweet?tweet_id=798538206492950528" target="_blank">retweet</a> • <a href="https://twitter.com/intent/favorite?tweet_id=798538206492950528" target="_blank">favorite</a> </div> </div> </div> </div> </div> </aside> </div> </div> </div> <footer id="colophon" class="site-footer" role="contentinfo"> <div class="site-info"> Copyright © 2014-2016 Jiří Materna. Všechna práva vyhrazena.  </div> </footer> </div>  <script type="text/javascript" src="http://www.mlguru.cz/wp-content/plugins/akismet/_inc/form.js?ver=3.1.8" /> <script type="text/javascript" src="http://www.mlguru.cz/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b" /> <script type="text/javascript" src="http://www.mlguru.cz/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.9b" /> <script type="text/javascript">
	(function(){
		var corecss = document.createElement(&apos;link&apos;);
		var themecss = document.createElement(&apos;link&apos;);
		var corecssurl = &quot;http://www.mlguru.cz/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b&quot;;
		if ( corecss.setAttribute ) {
				corecss.setAttribute( &quot;rel&quot;, &quot;stylesheet&quot; );
				corecss.setAttribute( &quot;type&quot;, &quot;text/css&quot; );
				corecss.setAttribute( &quot;href&quot;, corecssurl );
		} else {
				corecss.rel = &quot;stylesheet&quot;;
				corecss.href = corecssurl;
		}
		document.getElementsByTagName(&quot;head&quot;)[0].insertBefore( corecss, document.getElementById(&quot;syntaxhighlighteranchor&quot;) );
		var themecssurl = &quot;http://www.mlguru.cz/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b&quot;;
		if ( themecss.setAttribute ) {
				themecss.setAttribute( &quot;rel&quot;, &quot;stylesheet&quot; );
				themecss.setAttribute( &quot;type&quot;, &quot;text/css&quot; );
				themecss.setAttribute( &quot;href&quot;, themecssurl );
		} else {
				themecss.rel = &quot;stylesheet&quot;;
				themecss.href = themecssurl;
		}
		//document.getElementById(&quot;syntaxhighlighteranchor&quot;).appendChild(themecss);
		document.getElementsByTagName(&quot;head&quot;)[0].insertBefore( themecss, document.getElementById(&quot;syntaxhighlighteranchor&quot;) );
	})();
	SyntaxHighlighter.config.strings.expandSource = &apos;+ expand source&apos;;
	SyntaxHighlighter.config.strings.help = &apos;?&apos;;
	SyntaxHighlighter.config.strings.alert = &apos;SyntaxHighlighter\n\n&apos;;
	SyntaxHighlighter.config.strings.noBrush = &apos;Can\&apos;t find brush for: &apos;;
	SyntaxHighlighter.config.strings.brushNotHtmlScript = &apos;Brush wasn\&apos;t configured for html-script option: &apos;;
	SyntaxHighlighter.defaults[&apos;pad-line-numbers&apos;] = false;
	SyntaxHighlighter.defaults[&apos;toolbar&apos;] = false;
	SyntaxHighlighter.all();
</script> <link rel="stylesheet" id="wdstwitterwidget-css" href="http://www.mlguru.cz/wp-content/plugins/any-user-twitter-feed/css/wdstwitterwidget.css?ver=4.4.5" type="text/css" media="all" /> <style id="wdstwitterwidget-inline-css" type="text/css"> #wds-tweets a {color: #0084B4}#wds-container {background-color: #ffffff}#wds-header {border-bottom-color: #cccccc}#wds-container {border-color: #cccccc}.wds-copyright {border-top-color: #cccccc}.wds-tweet-container {border-bottom-color: #cccccc}#wds {color: #333333}a .wds-display-name {color: #333333}a .wds-screen-name {color: #999999}a:hover .wds-screen-name {color: #666666}#wds-header, #wds-header a {color: #333333} </style> <script type="text/javascript" src="http://www.mlguru.cz/wp-content/plugins/simple-share-buttons-adder/js/ssba.min.js?ver=4.4.5" /> <script type="text/javascript" src="http://www.mlguru.cz/wp-content/themes/radiate/js/navigation.js?ver=20120206" /> <script type="text/javascript" src="http://www.mlguru.cz/wp-content/themes/radiate/js/skip-link-focus-fix.js?ver=20130115" /> <script type="text/javascript">
/* &lt;![CDATA[ */
var radiateScriptParam = {&quot;radiate_image_link&quot;:&quot;http:\/\/www.mlguru.cz\/wp-content\/uploads\/2014\/11\/cropped-neurons2.png&quot;};
/* ]]&gt; */
</script> <script type="text/javascript" src="http://www.mlguru.cz/wp-content/themes/radiate/js/custom.js?ver=4.4.5" /> <script type="text/javascript" src="http://www.mlguru.cz/wp-includes/js/comment-reply.min.js?ver=4.4.5" /> <script type="text/javascript" src="http://www.mlguru.cz/wp-includes/js/wp-embed.min.js?ver=4.4.5" /> </body> </html> 