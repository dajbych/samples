    <html lang="en-US">  <head> <meta charset="UTF-8" /> <meta name="viewport" content="width=device-width" /> <title>Certificate validation mess on Mac OS X | All things digital</title> <link rel="profile" href="http://gmpg.org/xfn/11" /> <link rel="pingback" href="https://www.allthingsdigital.nl/xmlrpc.php" />  <link rel="dns-prefetch" href="//www.allthingsdigital.nl" /> <link rel="dns-prefetch" href="//fonts.googleapis.com" /> <link rel="dns-prefetch" href="//s.w.org" /> <link rel="alternate" type="application/rss+xml" title="All things digital » Feed" href="https://www.allthingsdigital.nl/feed/" /> <link rel="alternate" type="application/rss+xml" title="All things digital » Comments Feed" href="https://www.allthingsdigital.nl/comments/feed/" /> <link rel="alternate" type="application/rss+xml" title="All things digital » Certificate validation mess on Mac OS X Comments Feed" href="https://www.allthingsdigital.nl/2011/09/04/certificate-validation-mess-on-mac-os-x/feed/" /> <script type="text/javascript">
			window._wpemojiSettings = {&quot;baseUrl&quot;:&quot;https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/&quot;,&quot;ext&quot;:&quot;.png&quot;,&quot;svgUrl&quot;:&quot;https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/&quot;,&quot;svgExt&quot;:&quot;.svg&quot;,&quot;source&quot;:{&quot;concatemoji&quot;:&quot;https:\/\/www.allthingsdigital.nl\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1&quot;}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement(&quot;canvas&quot;),i=h.getContext&amp;&amp;h.getContext(&quot;2d&quot;),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline=&quot;top&quot;,i.font=&quot;600 32px Arial&quot;,a){case&quot;flag&quot;:return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length&lt;3e3)&amp;&amp;(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case&quot;diversity&quot;:return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+&quot;,&quot;+e[1]+&quot;,&quot;+e[2]+&quot;,&quot;+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+&quot;,&quot;+e[1]+&quot;,&quot;+e[2]+&quot;,&quot;+e[3],f!==g;case&quot;simple&quot;:return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case&quot;unicode8&quot;:return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case&quot;unicode9&quot;:return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement(&quot;script&quot;);c.src=a,c.type=&quot;text/javascript&quot;,b.getElementsByTagName(&quot;head&quot;)[0].appendChild(c)}var f,g,h,i;for(i=Array(&quot;simple&quot;,&quot;flag&quot;,&quot;unicode8&quot;,&quot;diversity&quot;,&quot;unicode9&quot;),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h&lt;i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&amp;&amp;c.supports[i[h]],&quot;flag&quot;!==i[h]&amp;&amp;(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&amp;&amp;c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&amp;&amp;!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener(&quot;DOMContentLoaded&quot;,g,!1),a.addEventListener(&quot;load&quot;,g,!1)):(a.attachEvent(&quot;onload&quot;,g),b.attachEvent(&quot;onreadystatechange&quot;,function(){&quot;complete&quot;===b.readyState&amp;&amp;c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&amp;&amp;f.twemoji&amp;&amp;(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> <style type="text/css"> img.wp-smiley, img.emoji { display: inline !important; border: none !important; box-shadow: none !important; height: 1em !important; width: 1em !important; margin: 0 .07em !important; vertical-align: -0.1em !important; background: none !important; padding: 0 !important; } </style> <link rel="stylesheet" id="otw_grid_manager-css" href="https://www.allthingsdigital.nl/wp-content/plugins/widgetize-pages-light/include/otw_components/otw_grid_manager/css/otw-grid.css?ver=1.1" type="text/css" media="all" /> <link rel="stylesheet" id="general_foundicons-css" href="https://www.allthingsdigital.nl/wp-content/plugins/widgetize-pages-light/include/otw_components/otw_shortcode/css/general_foundicons.css?ver=1.1" type="text/css" media="all" /> <link rel="stylesheet" id="social_foundicons-css" href="https://www.allthingsdigital.nl/wp-content/plugins/widgetize-pages-light/include/otw_components/otw_shortcode/css/social_foundicons.css?ver=1.1" type="text/css" media="all" /> <link rel="stylesheet" id="otw_shortocde-css" href="https://www.allthingsdigital.nl/wp-content/plugins/widgetize-pages-light/include/otw_components/otw_shortcode/css/otw_shortcode.css?ver=1.1" type="text/css" media="all" /> <link rel="stylesheet" id="twentyfourteen-lato-css" href="https://fonts.googleapis.com/css?family=Lato%3A300%2C400%2C700%2C900%2C300italic%2C400italic%2C700italic&subset=latin%2Clatin-ext" type="text/css" media="all" /> <link rel="stylesheet" id="genericons-css" href="https://www.allthingsdigital.nl/wp-content/themes/twentyfourteen/genericons/genericons.css?ver=3.0.3" type="text/css" media="all" /> <link rel="stylesheet" id="twentyfourteen-style-css" href="https://www.allthingsdigital.nl/wp-content/themes/twentyfourteen/style.css?ver=4.6.1" type="text/css" media="all" />  <link rel="stylesheet" id="wp-html-sitemap-style-css" href="https://www.allthingsdigital.nl/wp-content/plugins/wp-html-sitemap/css/sitemap.css?ver=4.6.1" type="text/css" media="all" /> <script type="text/javascript" src="https://www.allthingsdigital.nl/wp-includes/js/jquery/jquery.js?ver=1.12.4" /> <script type="text/javascript" src="https://www.allthingsdigital.nl/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" /> <link rel="https://api.w.org/" href="https://www.allthingsdigital.nl/wp-json/" /> <link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.allthingsdigital.nl/xmlrpc.php?rsd" /> <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.allthingsdigital.nl/wp-includes/wlwmanifest.xml" /> <link rel="prev" title="Java source and documentation on Mac OS X Lion" href="https://www.allthingsdigital.nl/2011/08/02/java-source-and-documentation-on-mac-os-x-lion/" /> <link rel="next" title="Create a DNS redirector with Apache RewriteMaps" href="https://www.allthingsdigital.nl/2012/01/17/create-a-dns-redirector-with-apache-rewritemaps/" /> <meta name="generator" content="WordPress 4.6.1" /> <link rel="canonical" href="https://www.allthingsdigital.nl/2011/09/04/certificate-validation-mess-on-mac-os-x/" /> <link rel="shortlink" href="https://www.allthingsdigital.nl/?p=56" /> <link rel="alternate" type="application/json+oembed" href="https://www.allthingsdigital.nl/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.allthingsdigital.nl%2F2011%2F09%2F04%2Fcertificate-validation-mess-on-mac-os-x%2F" /> <link rel="alternate" type="text/xml+oembed" href="https://www.allthingsdigital.nl/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.allthingsdigital.nl%2F2011%2F09%2F04%2Fcertificate-validation-mess-on-mac-os-x%2F&format=xml" /> <style type="text/css" id="syntaxhighlighteranchor" /> </head> <body class="single single-post postid-56 single-format-standard masthead-fixed singular"> <div id="page" class="hfeed site"> <header id="masthead" class="site-header" role="banner"> <div class="header-main"> <h1 class="site-title"><a href="https://www.allthingsdigital.nl/" rel="home">All things digital</a></h1> <div class="search-toggle"> <a href="#search-container" class="screen-reader-text" aria-expanded="false" aria-controls="search-container">Search</a> </div> <nav id="primary-navigation" class="site-navigation primary-navigation" role="navigation"> <button class="menu-toggle">Primary Menu</button> <a class="screen-reader-text skip-link" href="#content">Skip to content</a> <div class="menu-main-menu-container"><ul id="primary-menu" class="nav-menu"><li id="menu-item-234" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-has-children menu-item-234"><a href="http://www.allthingsdigital.nl/">Home</a> <ul class="sub-menu"> <li id="menu-item-315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-315"><a href="https://www.allthingsdigital.nl/sitemap/">Sitemap</a></li> <li id="menu-item-316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-316"><a href="https://www.allthingsdigital.nl/privacy-cookies/">Privacy &amp; cookies</a></li> <li id="menu-item-165" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-165"><a href="https://www.allthingsdigital.nl/about/">About me</a></li> </ul> </li> <li id="menu-item-230" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-230"><a href="https://www.allthingsdigital.nl/category/how-to/">HOWTO</a></li> <li id="menu-item-231" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-231"><a href="https://www.allthingsdigital.nl/category/review/">Review</a></li> <li id="menu-item-232" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-232"><a href="https://www.allthingsdigital.nl/category/column/">Column</a></li> <li id="menu-item-233" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-233"><a href="https://www.allthingsdigital.nl/category/tips-and-tricks/">Tips &amp; Tricks</a></li> <li id="menu-item-336" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-336"><a href="/wp-login.php">Login</a></li> </ul></div> </nav> </div> <div id="search-container" class="search-box-wrapper hide"> <div class="search-box"> <form role="search" method="get" class="search-form" action="https://www.allthingsdigital.nl/"> <label> <span class="screen-reader-text">Search for:</span> <input type="search" class="search-field" placeholder="Search …" value name="s" /> </label> <input type="submit" class="search-submit" value="Search" /> </form> </div> </div> </header> <div id="main" class="site-main"> <div id="primary" class="content-area"> <div id="content" class="site-content" role="main"> <article id="post-56" class="post-56 post type-post status-publish format-standard hentry category-column tag-mac tag-security tag-sysadm"> <header class="entry-header"> <div class="entry-meta"> <span class="cat-links"><a href="https://www.allthingsdigital.nl/category/column/" rel="category tag">Column</a></span> </div> <h1 class="entry-title">Certificate validation mess on Mac OS X</h1> <div class="entry-meta"> <span class="entry-date"><a href="https://www.allthingsdigital.nl/2011/09/04/certificate-validation-mess-on-mac-os-x/" rel="bookmark"><time class="entry-date" datetime="2011-09-04T15:20:08+00:00">September 4, 2011</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="https://www.allthingsdigital.nl/author/admin/" rel="author">David van Enckevort</a></span></span> <span class="comments-link"><a href="https://www.allthingsdigital.nl/2011/09/04/certificate-validation-mess-on-mac-os-x/#respond">Leave a comment</a></span> </div> </header> <div class="entry-content"> <p>The recent events at Diginotar turned my attention again to the way Apple handles certificates in MacOS X. Apple makes use of certificates not only in the browser for the standard SSL/TLS support, but it is also an integral part of the security system of Mac OS X. Both the App store and the application firewall make use of certificates:</p> <ul> <li>All applications in the App store must be signed by the developer.</li> <li>The application firewall whitelists uses the certificate of an application to maintain the whitelist over different releases of the software.</li> <li>The application firewall whitelists Apple’s software based on the signature with the Apple certificate.</li> </ul> <p>So far, things look good. However, when I tested what happens with the websites that use a diginotar PKIOverheid certificate I noticed that they were still accepted even though the Dutch Government revoked the intermediate certificate and updated OCSP to reflect that.</p> <p style="text-align: center;"><a href="http://www.allthingsdigital.nl/wp-content/uploads/2011/09/PKIOverheid-revoked-intermediate-certificate-still-accepted.png"><img class="size-full wp-image-68 aligncenter" title="PKIOverheid revoked intermediate certificate still accepted" src="http://www.allthingsdigital.nl/wp-content/uploads/2011/09/PKIOverheid-revoked-intermediate-certificate-still-accepted.png" alt width="485" height="296" srcset="https://www.allthingsdigital.nl/wp-content/uploads/2011/09/PKIOverheid-revoked-intermediate-certificate-still-accepted.png 485w, https://www.allthingsdigital.nl/wp-content/uploads/2011/09/PKIOverheid-revoked-intermediate-certificate-still-accepted-300x183.png 300w" sizes="(max-width: 485px) 100vw, 485px" /></a></p> <p>A quick look at the keychain preferences showed me that OCSP (Online Certificate Status Protocol) and CRL (Certificate Revocation List) were both disabled. I changed both settings to ‘Required when certificate indicate’ and Safari started to behave like I expected. (I know there is a different solution as <a title="Protecting your Mac from the Diginotar.nl certificate compromise." href="http://ps-enable.com/articles/diginotar-revoke-trust" target="_blank">outlined here</a>, but I don’t want to keep track of things the computer can keep track of for me)</p> <p style="text-align: center;"><a href="http://www.allthingsdigital.nl/wp-content/uploads/2011/09/With-online-verification-the-intermediate-is-no-longer-trusted.png"><img class="size-full wp-image-70 aligncenter" title="With online verification the intermediate is no longer trusted" src="http://www.allthingsdigital.nl/wp-content/uploads/2011/09/With-online-verification-the-intermediate-is-no-longer-trusted.png" alt width="536" height="451" srcset="https://www.allthingsdigital.nl/wp-content/uploads/2011/09/With-online-verification-the-intermediate-is-no-longer-trusted.png 536w, https://www.allthingsdigital.nl/wp-content/uploads/2011/09/With-online-verification-the-intermediate-is-no-longer-trusted-300x252.png 300w" sizes="(max-width: 536px) 100vw, 536px" /></a></p> <p style="text-align: left;">So, everything is fine? Not really! With this setting I noticed something annoying. The App store didn’t work anymore and was dreadfully slow.</p> <p style="text-align: center;"><a href="http://www.allthingsdigital.nl/wp-content/uploads/2011/09/App-store-fails-to-install-with-OCSP-and-CRL-set-to-require-if-certificate-indicates.png"><img class="size-full wp-image-66 aligncenter" title="App store fails to install with OCSP and CRL set to require if certificate indicates" src="http://www.allthingsdigital.nl/wp-content/uploads/2011/09/App-store-fails-to-install-with-OCSP-and-CRL-set-to-require-if-certificate-indicates.png" alt width="420" height="133" srcset="https://www.allthingsdigital.nl/wp-content/uploads/2011/09/App-store-fails-to-install-with-OCSP-and-CRL-set-to-require-if-certificate-indicates.png 420w, https://www.allthingsdigital.nl/wp-content/uploads/2011/09/App-store-fails-to-install-with-OCSP-and-CRL-set-to-require-if-certificate-indicates-300x95.png 300w" sizes="(max-width: 420px) 100vw, 420px" /></a></p> <p>It looks like Apple is doing loads of CRL and OCSP requests during startup of the application and some more when trying to install or update an application. However, by playing around with the keychain settings I found out that the CRL requests fail and therefor the installation is (correctly) denied. I don’t mind that, but there are a couple of things that do bother me.</p> <ol> <li>Why does it make the App store dreadfully slow? The certificates only have to be validated upon installation, a secured connection to the App Store should be sufficient protection for the catalogue.</li> <li>Why do I get such a cryptic error message?</li> <li>But above all, how it is possible that the App Store contains packages that fail to install if CRL validation is set to “Required when certificate indicate”.</li> </ol> <p>To have a reliable system we should be able to trust that it is correctly configured. The default configuration on Mac OS X is a mess. An important function, CRL and OCSP online validation of certificates is disabled by default. When we enable it an integral part of the Mac OS X ecosystem fails, because of an apparent incorrect configuration of the developer certificates used to sign software in the App store.</p> </div> <footer class="entry-meta"><span class="tag-links"><a href="https://www.allthingsdigital.nl/tag/mac/" rel="tag">Mac OS X</a><a href="https://www.allthingsdigital.nl/tag/security/" rel="tag">Security</a><a href="https://www.allthingsdigital.nl/tag/sysadm/" rel="tag">System Administration</a></span></footer></article> <nav class="navigation post-navigation" role="navigation"> <h1 class="screen-reader-text">Post navigation</h1> <div class="nav-links"> <a href="https://www.allthingsdigital.nl/2011/08/02/java-source-and-documentation-on-mac-os-x-lion/" rel="prev"><span class="meta-nav">Previous Post</span>Java source and documentation on Mac OS X Lion</a><a href="https://www.allthingsdigital.nl/2012/01/17/create-a-dns-redirector-with-apache-rewritemaps/" rel="next"><span class="meta-nav">Next Post</span>Create a DNS redirector with Apache RewriteMaps</a> </div> </nav> <div id="comments" class="comments-area"> <div id="respond" class="comment-respond"> <h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2011/09/04/certificate-validation-mess-on-mac-os-x/#respond" style="display:none;">Cancel reply</a></small></h3> <form action="https://www.allthingsdigital.nl/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate> <p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required" /></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value size="30" maxlength="245" aria-required="true" required="required" /></p> <p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" /></p> <p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value size="30" maxlength="200" /></p> <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type="hidden" name="comment_post_ID" value="56" id="comment_post_ID" /> <input type="hidden" name="comment_parent" id="comment_parent" value="0" /> </p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="44a40eeef2" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="74" /></p> </form> </div> </div> </div> </div> <div id="content-sidebar" class="content-sidebar widget-area" role="complementary"> <aside id="text-3" class="widget widget_text"><h1 class="widget-title">License</h1> <div class="textwidget"><p>This work by <a href="http://www.vanenckevort.net/about-me/" property="cc:attributionName" rel="cc:attributionURL" xmlns:cc="http://creativecommons.org/ns#">David van Enckevort</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p> <p><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></p> </div> </aside> <aside id="recent-posts-4" class="widget widget_recent_entries"> <h1 class="widget-title">Recent Posts</h1> <ul> <li> <a href="https://www.allthingsdigital.nl/2014/07/24/a-trick-to-upload-large-files-to-box-com/">A trick to upload large files to box.com</a> </li> <li> <a href="https://www.allthingsdigital.nl/2013/11/07/crashplan-on-mavericks-with-java-1-7/">CrashPlan on Mavericks with Java 1.7</a> </li> <li> <a href="https://www.allthingsdigital.nl/2013/09/21/managed-configuration-in-spring/">Managed configuration in Spring</a> </li> <li> <a href="https://www.allthingsdigital.nl/2013/05/12/setting-up-an-sftp-only-account-with-openssh/">Setting up an SFTP-only account with OpenSSH</a> </li> <li> <a href="https://www.allthingsdigital.nl/2012/10/07/automated-image-manipulation-on-the-mac-for-pre-printing/">Automated image manipulation on the Mac for pre-printing</a> </li> </ul> </aside> <aside id="text-4" class="widget widget_text"><h1 class="widget-title">Statistics</h1> <div class="textwidget"><iframe src="https://www.vanenckevort.net/analytics/index.php?module=CoreAdminHome&action=optOut&language=nl" /></div> </aside></div> <div id="secondary"> <h2 class="site-description">Thoughts about things digital</h2> <nav role="navigation" class="navigation site-navigation secondary-navigation"> <div class="menu-social-container"><ul id="menu-social" class="menu"><li id="menu-item-334" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-334"><a href="https://www.vanenckevort.net/">Personal site</a></li> <li id="menu-item-335" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-335"><a href="/feed/">RSS</a></li> <li id="menu-item-332" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-332"><a href="https://www.facebook.com/djvanenckevort">Facebook</a></li> <li id="menu-item-333" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-333"><a href="https://www.linkedin.com/in/djvanenckevort">LinkedIn</a></li> </ul></div> </nav> </div> </div> <footer id="colophon" class="site-footer" role="contentinfo"> <div class="site-info"> <a href="https://wordpress.org/">Proudly powered by WordPress</a> </div> </footer> </div> <script type="text/javascript" src="https://www.allthingsdigital.nl/wp-content/plugins/akismet/_inc/form.js?ver=3.2" /> <script type="text/javascript" src="https://www.allthingsdigital.nl/wp-content/themes/twentyfourteen/js/functions.js?ver=20150315" /> <script type="text/javascript" src="https://www.allthingsdigital.nl/wp-includes/js/wp-embed.min.js?ver=4.6.1" /> </body> </html>